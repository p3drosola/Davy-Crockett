<html>
<head>
	<title>Client # Davy Crockett</title>
	<script src="socket.io/socket.io.js"></script>
	<script src="browserDetect.js"></script>
	<script>

	var indian = {

		'conf' : function(configuraiton) {
			// TODO: merge config with defaults
			this.conf = configuration;	
		},

		'init' : function(){

			this.id;
			this.tailing = false;
			this.socket = io.connect('http://localhost:8000/tracker');

			// get client details
			BrowserDetect.init();
			var details = {
				os : BrowserDetect.OS,
				browser : BrowserDetect.browser,
				browserVersion : BrowserDetect.version
			};

			this.socket.on('connect', function(t){
				console.log('indian spawned:'+this.socket.sessionid);
				this.id = this.socket.sessionid;
			});
			this.socket.emit('open page', { 
				url: window.location.href,
				details: details ,
				groupBy: 'ip'
				}
			);

			this.socket.on('tailing', function(){
				alert('looks like i\'m being tailed! '+this.id);
				this.tailing = true;
			});
		},
		'move' : function(){
			this.socket.emit('mousemove', {'x':23, 'y':56});
		}
	};
	//indian.conf({});
	indian.init();
		  
	</script>
</head>
<body>
	<h3>Hello world!</h3>
	<p>This page is using Davy to track users in real-time! (as opposed to fake time, which is such a drag)</p>
	<button id="interact" onclick="javscript:alert('an action!');" >interact</button>
</body>
</html>